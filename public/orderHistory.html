<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./assets/css/root.css" />
    <link rel="stylesheet" href="./assets/css/admin.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="alert"></div>

    <div class="dashboard_admin_body">
      <div class="sidebar">
        <a class="toggler" onclick="hideSidebar()">
          <i class="fa fa-bars"></i>
        </a>
        <img src="./assets/images/logo.png" alt="" />
        <a href="adminDashboard.html">
          <i class="fa fa-dashboard"></i>
          <span class="names">Dashboard</span>
        </a>
        <a href="addBooks.html">
          <i class="fa fa-plus"></i>
          <span class="names">Add Books</span>
        </a>
        <a href="updateBooks.html">
          <i class="fa fa-pencil-square"></i>
          <span class="names">Update books</span>
        </a>
        <a href="deleteBooks.html">
          <i class="fa fa-trash"></i>
          <span class="names">Delete Books</span>
        </a>
        <a href="ordersAdmin.html">
          <i class="fa fa-sort-amount-desc"></i>
          <span class="names">Ongoing Orders</span>
        </a>
        <a href="#">
          <i class="fa fa fa-history"></i>
          <span class="names">Order history</span>
        </a>

        <a href="" onclick="logout(event)">
          <i class="fa fa-sign-out"></i>
          <span class="names">Logout</span>
        </a>
      </div>

      <!-- Main Content -->
      <div class="main">
        <div class="header">
          <h1>Welcome,<span>Admin</span>ðŸ‘‹</h1>
          <h3>Orders History</h3>
        </div>

        <div class="card orders">
          <h4>Orders</h4>
          <div class="card">
            <table border="0" width="100%">
              <thead>
                <tr>
                  <th>Order id</th>
                  <th>Customer</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="orders-history">
                <tr>
                  <td colspan="4">No data available</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <script src="./assets/js/reusableFunctions.js"></script>
    <script src="./assets/js/admin.js"></script>
    <script>
      const ordersHistoryTable = document.getElementById("orders-history");
      const fetchOrders = () => {
        connectBackEnd({
          backendUrl: "../backend/orders_get_from_status.php",
          callback: (data) => {
            console.log(data);
            if (data.success) {
              ordersHistoryTable.innerHTML = "";
              data.data.forEach((order) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                 <td>${order.order_id}</td>
                    <td>${order.customer_name}</td>
                    <td>$${order.total}</td>
                    <td>${order.status}</td>
                    <td><a href="order_details.html?order_id=${order.order_id}">View Details</a></td>
                  `;
                ordersHistoryTable.appendChild(row);
              });
            } else {
              ordersHistoryTable.innerHTML = `
                  <tr>
                    <td colspan="5">${data.message || "No data available"}</td>
                  </tr>
                `;
            }
          },
        });
      };
      fetchOrders();
    </script>
  </body>
</html>
