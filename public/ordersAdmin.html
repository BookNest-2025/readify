<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./assets/css/root.css" />
    <link rel="stylesheet" href="./assets/css/admin.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="alert"></div>

    <div class="dashboard_admin_body">
      <div class="sidebar">
        <a class="toggler" onclick="hideSidebar()">
          <i class="fa fa-bars"></i>
        </a>
        <img src="./assets/images/logo.png" alt="" />
        <a href="#">
          <i class="fa fa-dashboard"></i>
          <span class="names">Dashboard</span>
        </a>
        <a href="addBooks.html">
          <i class="fa fa-plus"></i>
          <span class="names">Add Books</span>
        </a>
        <a href="updateBooks.html">
          <i class="fa fa-pencil-square"></i>
          <span class="names">Update books</span>
        </a>
        <a href="deleteBooks.html">
          <i class="fa fa-trash"></i>
          <span class="names">Delete Books</span>
        </a>
        <a href="#orders">
          <i class="fa fa-sort-amount-desc"></i>
          <span class="names">Ongoing Orders</span>
        </a>
        <a href="#orders">
          <i class="fa fa fa-history"></i>
          <span class="names">Order history</span>
        </a>

        <a href="" onclick="logout()">
          <i class="fa fa-sign-out"></i>
          <span class="names">Logout</span>
        </a>
      </div>

      <!-- Main Content -->
      <div class="main">
        <div class="header">
          <h1>Welcome,<span>Admin</span>ðŸ‘‹</h1>
          <h3>Orders</h3>
        </div>

        <div class="card orders">
          <h4>To pack</h4>
          <div class="card">
            <table border="0" width="100%">
              <thead>
                <tr>
                  <th>Customer</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="to-pack">
                <tr>
                  <td colspan="4">No data available</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="card orders">
          <h4>To Ship</h4>
          <div class="card">
            <table border="0" width="100%">
              <thead>
                <tr>
                  <th>Customer</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="to-ship">
                <tr>
                  <td colspan="4">No data available</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="card orders">
          <h4>Shipped</h4>
          <div class="card">
            <table border="0" width="100%">
              <thead>
                <tr>
                  <th>Customer</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="shipped">
                <tr>
                  <td colspan="4">No data available</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="card orders">
          <h4>Cancelled</h4>
          <div class="card">
            <table border="0" width="100%">
              <thead>
                <tr>
                  <th>Customer</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="cancelled">
                <tr>
                  <td colspan="4">No data available</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <script src="./assets/js/reusableFunctions.js"></script>
    <script src="./assets/js/admin.js"></script>
    <script>
      const getOrders = (status, elementId) => {
        const element = document.getElementById(elementId);
        connectBackEnd({
          backendUrl: "../backend/get_orders.php?status=" + status,
          callback: (data) => {
            if (!data.success) {
              element.innerHTML =
                '<tr><td colspan="4">No data available</td></tr>';
              return;
            }
            let rows = "";
            data.data.forEach((order) => {
              rows += `
                <tr>
                  <td>${order.customer_name}</td>
                  <td>${order.total} LKR</td>
                  <td>${order.status}</td>
                  <td><button><a href="order_details.html?order_id=${order.order_id}">View</a></button></td>
                </tr>
              `;
            });
            element.innerHTML = rows;
          },
        });
      };

      getOrders("placed", "to-pack");
      getOrders("packed", "to-ship");
      getOrders("shipped", "shipped");
      getOrders("cancelled", "cancelled");
    </script>
  </body>
</html>
